<!--pages/rsscenter/rsscenter.wxml-->
<view class="discover">
  <view class='searchbar'>
    <l-search-bar bind:linconfirm="handleSearch" bind:linblur="handleSearch" bind:linchange="handleSearch" bind:linfocus="handleSearch" clear="{{true}}" placeholder="搜索" />
  </view>

  <!-- 搜索模式 -->
  <view wx:if="{{searchMode}}">
    <view wx:for="{{rssData}}" wx:for-item="cates" wx:key="{{index}}" wx:for-index="idx">
      <view class='search-col' wx:for="{{cates.items}}" wx:for-item="sitem" wx:key="" wx:for-index="id" wx:if="{{sitem.matched}}">
        <view bindtap='onTap' data-cate="{{idx}}" data-item="{{id}}">
          <image class='search-source-icon' src='{{sitem.favicon}}'></image>
          <view class='rss-title'>{{sitem.title}}</view>
          <view class='rss-description'>{{sitem.description}}</view>
        </view> 
        <l-button special="{{true}}" wx:if="{{sitem.rssed==1}}" bind:lintap="onChange" data-cate="{{idx}}" data-item="{{id}}">
          <view class="container">
            <image mode="aspectFit" class="subs-checked" src='../../images/check.png'></image>
          </view>
        </l-button>
        <l-button special="{{true}}" bind:lintap="onChange" data-cate="{{idx}}" data-item="{{id}}" wx:else>
          <view class="container">
            <image mode="aspectFit" class="subs" src='../../images/add.png'></image>
          </view>
        </l-button>
      </view>
    </view>
  </view>

  <!-- 普通模式 -->
  <view wx:if="{{!searchMode}}" wx:for="{{rssData}}" wx:for-item="cates" wx:key="{{index}}" wx:for-index="idx">
    <view class="cate-name">
      <image class='cate-icon' src="{{'../../images/'+idx+'.png'}}"></image>
      {{cates.cate}}
    </view>
    <scroll-view scroll-x class='cate-list'>
      <view class='source-item' wx:for="{{cates.items}}" wx:for-item="item" wx:key="" wx:for-index="id">
        <view bindtap='onTap' data-cate="{{idx}}" data-item="{{id}}">
          <image class='source-icon' src='{{item.favicon}}'></image>
          <view class='source-title'>{{item.title}}</view>
        </view>
        <l-button special="{{true}}" wx:if="{{item.rssed==1}}" bind:lintap="onChange" data-cate="{{idx}}" data-item="{{id}}">
          <view class="container">
            <image mode="aspectFit" class="subs-checked" src='../../images/check.png'></image>
          </view>
        </l-button>
        <l-button special="{{true}}" bind:lintap="onChange" data-cate="{{idx}}" data-item="{{id}}" wx:else>
          <view class="container">
            <image mode="aspectFit" class="subs" src='../../images/add.png'></image>
          </view>
        </l-button>
      </view>
    </scroll-view>
  </view>

</view>

<l-button class="favor" l-class="button" size="long" bind:lintap="navToMy">我的订阅</l-button>